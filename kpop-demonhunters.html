<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Which K-Pop Demon Hunter Are You?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(circle, #2c1a2b, #111827);
        }
        .quiz-container {
            background-color: rgba(26, 32, 44, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(147, 51, 234, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 25px rgba(147, 51, 234, 0.2) inset;
        }
        .answer-btn {
            transition: all 0.3s ease;
            transform-style: preserve-3d;
            font-size: 1.1rem;
            padding: 1rem;
        }
        .answer-btn:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 8px 20px rgba(147, 51, 234, 0.3);
            background-color: #581c87;
        }
        .question-card, .result-card, #start-screen {
            animation: fadeIn 0.8s ease-in-out;
        }
        h1, h2 {
             text-shadow: 0 0 8px rgba(255, 255, 255, 0.1);
        }
        .progress-bar-glow {
            box-shadow: 0 0 10px #a855f7, 0 0 20px #a855f7;
        }
        #start-btn {
             box-shadow: 0 0 20px #9333ea;
        }
        .question-image {
            animation: imageFadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes imageFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 text-gray-200">

    <div id="quiz-container" class="quiz-container w-full max-w-3xl rounded-2xl p-6 md:p-10">
        <!-- Quiz Start Screen -->
        <div id="start-screen">
            <h1 class="text-4xl md:text-5xl font-bold text-center text-purple-400 mb-4 tracking-wider">Demon Hunter Profile</h1>
            <p class="text-center text-gray-300 mb-8 text-lg">Your spirit resonates with a unique power. Uncover the balance of forces within you.</p>
            <div class="flex justify-center">
                <button id="start-btn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-10 rounded-full text-xl shadow-lg transition-transform transform hover:scale-105">Begin Analysis</button>
            </div>
        </div>

        <!-- Quiz Questions -->
        <div id="question-container" class="hidden question-card">
            <div class="w-full bg-gray-700 rounded-full h-3 mb-4">
                <div id="progress-bar" class="bg-purple-500 h-3 rounded-full progress-bar-glow transition-all duration-500 ease-out"></div>
            </div>
            <div id="image-container" class="mb-6 w-full h-48 rounded-lg overflow-hidden">
                 <!-- Image will be inserted here -->
            </div>
            <h2 id="question-text" class="text-2xl font-semibold mb-6 text-center text-gray-100"></h2>
            <div id="answer-buttons" class="grid grid-cols-1 gap-4">
                <!-- Answer buttons will be generated here -->
            </div>
        </div>

        <!-- Quiz Results -->
        <div id="result-container" class="hidden text-center result-card">
             <div id="capture-area" class="bg-gray-800/50 p-6 rounded-lg">
                <h2 class="text-3xl font-semibold text-gray-200 mb-2">Your Personality Profile</h2>
                <div class="w-full max-w-sm mx-auto my-6">
                    <canvas id="result-chart"></canvas>
                </div>
                <h1 id="result-name" class="text-4xl font-bold text-purple-400 mb-4"></h1>
                <p id="result-description" class="text-lg text-gray-300 mb-8 max-w-xl mx-auto"></p>
            </div>
            <div class="mt-8 flex justify-center gap-4">
                <button id="restart-btn" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-full text-lg transition-transform transform hover:scale-105">Analyze Again</button>
                <button id="share-btn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full text-lg transition-transform transform hover:scale-105">Share Result</button>
            </div>
        </div>
    </div>

    <script>
        const startBtn = document.getElementById('start-btn');
        const startScreen = document.getElementById('start-screen');
        const questionContainer = document.getElementById('question-container');
        const resultContainer = document.getElementById('result-container');
        const questionText = document.getElementById('question-text');
        const answerButtons = document.getElementById('answer-buttons');
        const imageContainer = document.getElementById('image-container');
        const restartBtn = document.getElementById('restart-btn');
        const shareBtn = document.getElementById('share-btn');
        const progressBar = document.getElementById('progress-bar');
        const resultChartCanvas = document.getElementById('result-chart');
        let resultChart;

        let currentQuestionIndex = 0;
        let scores = { rumi: 0, zoey: 0, mira: 0 };

        const questions = [
            {
                question: "A storm is coming. Where do you find shelter?",
                image: "https://images.pexels.com/photos/1118873/pexels-photo-1118873.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
                answers: [
                    { text: "In a lighthouse, guiding others to safety.", points: { rumi: 10, mira: 4, zoey: 1 } },
                    { text: "On a high cliff, feeling the wind and the raw power of the waves.", points: { zoey: 10, mira: 1, rumi: 2 } },
                    { text: "In an ancient library, studying maps of past storms.", points: { mira: 10, rumi: 5, zoey: 0 } }
                ]
            },
            {
                question: "You are given a key. What does it unlock?",
                image: "https://images.pexels.com/photos/134064/pexels-photo-134064.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
                answers: [
                    { text: "A hidden garden, a sanctuary for my loved ones.", points: { rumi: 10, zoey: 3, mira: 3 } },
                    { text: "A treasure chest, filled with untold power and adventure.", points: { zoey: 10, mira: 2, rumi: 3 } },
                    { text: "A forbidden archive, holding the secrets of the universe.", points: { mira: 10, rumi: 2, zoey: 4 } }
                ]
            },
            {
                question: "You stand before a crossroads. Which path do you choose?",
                image: "https://images.pexels.com/photos/397237/pexels-photo-397237.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
                answers: [
                    { text: "The well-trodden path, where I can protect other travelers.", points: { rumi: 10, mira: 3, zoey: 1 } },
                    { text: "The overgrown, unmarked path that promises the unknown.", points: { zoey: 10, mira: 4, rumi: 2 } },
                    { text: "I'll climb a tree to see where all the paths lead first.", points: { mira: 10, rumi: 3, zoey: 3 } }
                ]
            },
            {
                question: "What is your weapon of choice in a debate?",
                image: "https://images.pexels.com/photos/3184431/pexels-photo-3184431.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
                answers: [
                    { text: "Unshakable conviction and passion.", points: { zoey: 10, rumi: 4, mira: 1 } },
                    { text: "Inescapable logic and well-researched facts.", points: { mira: 10, rumi: 3, zoey: 1 } },
                    { text: "Empathy and the ability to find common ground.", points: { rumi: 10, mira: 4, zoey: 2 } }
                ]
            },
            {
                question: "A single candle flickers in a dark room. What does it represent?",
                image: "https://images.pexels.com/photos/1570807/pexels-photo-1570807.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
                answers: [
                    { text: "A mystery to be solved before the light goes out.", points: { mira: 10, zoey: 4, rumi: 2 } },
                    { text: "A hope that must be protected at all costs.", points: { rumi: 10, mira: 3, zoey: 3 } },
                    { text: "A challenge to the darkness; a spark ready to become a wildfire.", points: { zoey: 10, rumi: 3, mira: 1 } }
                ]
            }
        ];
        
        const results = {
            rumi: {
                name: "The Steadfast Guardian",
                description: "Your core is defined by responsibility and empathy. You are the anchor in the storm, finding strength not in personal glory, but in the unity and safety of your team. You lead with a quiet confidence that inspires loyalty."
            },
            zoey: {
                name: "The Unbound Force",
                description: "You are a whirlwind of passion and instinct. You live in the moment, trusting your heart and your power to carve a path through any obstacle. Your energy is infectious, making you the undeniable, beating heart of any group."
            },
            mira: {
                name: "The Arcane Scholar",
                description: "Your mind is your greatest weapon. You see the world as a complex puzzle and thrive on deciphering its secrets. You find power in knowledge and strategy, always staying three steps ahead of your adversaries."
            }
        };

        startBtn.addEventListener('click', startQuiz);
        restartBtn.addEventListener('click', startQuiz);
        shareBtn.addEventListener('click', shareResult);

        function shareResult() {
            const captureArea = document.getElementById('capture-area');
            html2canvas(captureArea, { 
                backgroundColor: '#1a202c', // Match the dark background
                useCORS: true 
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'demon-hunter-profile.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }

        function startQuiz() {
            startScreen.classList.add('hidden');
            resultContainer.classList.add('hidden');
            questionContainer.classList.remove('hidden');
            
            currentQuestionIndex = 0;
            scores = { rumi: 0, zoey: 0, mira: 0 };
            
            updateProgressBar();
            showNextQuestion();
        }

        function showNextQuestion() {
            resetState();
            if (currentQuestionIndex < questions.length) {
                const question = questions[currentQuestionIndex];
                
                const img = document.createElement('img');
                img.src = question.image;
                img.alt = "Quiz thematic image";
                img.className = "question-image w-full h-full object-cover";
                img.onerror = function() {
                    this.onerror=null;
                    this.src='https://placehold.co/600x400/1a202c/a78bfa?text=Image+Not+Found';
                };
                imageContainer.appendChild(img);

                questionText.innerText = question.question;
                question.answers.forEach(answer => {
                    const button = document.createElement('button');
                    button.innerText = answer.text;
                    button.classList.add('answer-btn', 'bg-gray-800', 'p-4', 'rounded-lg', 'text-left', 'w-full', 'hover:bg-purple-900', 'border', 'border-purple-500/30');
                    button.dataset.points = JSON.stringify(answer.points);
                    button.addEventListener('click', selectAnswer);
                    answerButtons.appendChild(button);
                });
            } else {
                showResults();
            }
        }

        function resetState() {
            while (answerButtons.firstChild) {
                answerButtons.removeChild(answerButtons.firstChild);
            }
            while (imageContainer.firstChild) {
                imageContainer.removeChild(imageContainer.firstChild);
            }
        }

        function selectAnswer(e) {
            const points = JSON.parse(e.currentTarget.dataset.points);
            scores.rumi += points.rumi;
            scores.zoey += points.zoey;
            scores.mira += points.mira;
            
            currentQuestionIndex++;
            updateProgressBar();
            showNextQuestion();
        }
        
        function updateProgressBar() {
            const progressPercentage = (currentQuestionIndex / questions.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;
        }

        function showResults() {
            questionContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');

            const totalScore = scores.rumi + scores.zoey + scores.mira;
            
            if (totalScore === 0) {
                 scores = { rumi: 1, zoey: 1, mira: 1 }; 
            }

            const percentages = {
                rumi: Math.round((scores.rumi / (totalScore || 1)) * 100),
                zoey: Math.round((scores.zoey / (totalScore || 1)) * 100),
                mira: Math.round((scores.mira / (totalScore || 1)) * 100)
            };
            
            let primaryCharacter = Object.keys(percentages).reduce((a, b) => percentages[a] > percentages[b] ? a : b);

            const resultData = results[primaryCharacter];
            document.getElementById('result-name').innerText = `Primary Archetype: ${resultData.name}`;
            document.getElementById('result-description').innerText = resultData.description;

            renderPieChart(percentages);
        }

        function renderPieChart(percentages) {
            if(resultChart) {
                resultChart.destroy();
            }
            resultChart = new Chart(resultChartCanvas, {
                type: 'pie',
                data: {
                    labels: [
                        `Rumi (${percentages.rumi}%)`, 
                        `Zoey (${percentages.zoey}%)`, 
                        `Mira (${percentages.mira}%)`
                    ],
                    datasets: [{
                        data: [percentages.rumi, percentages.zoey, percentages.mira],
                        backgroundColor: [
                            'rgba(168, 85, 247, 0.7)', // Rumi - Purple
                            'rgba(219, 39, 119, 0.7)', // Zoey - Pink
                            'rgba(59, 130, 246, 0.7)'  // Mira - Blue
                        ],
                        borderColor: [
                            '#a855f7',
                            '#db2777',
                            '#3b82f6'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#D1D5DB',
                                font: {
                                    size: 14
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

    </script>
</body>
</html>
